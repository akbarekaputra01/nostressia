- name: Push backend to hub
  env:
    HF_TOKEN: ${{ secrets.HF_TOKEN }}
  run: |
    set -e

    REPO_URL="https://akbarekaputra01:${HF_TOKEN}@huggingface.co/spaces/akbarekaputra01/nostressia-backend.git"

    # pastikan folder backend ada
    test -d "nostressia-backend"

    # buat repo sementara dari isi folder backend
    rm -rf /tmp/hf-backend
    mkdir -p /tmp/hf-backend
    rsync -av --delete nostressia-backend/ /tmp/hf-backend/

    cd /tmp/hf-backend
    git init
    git lfs install

    git config user.email "actions@github.com"
    git config user.name "github-actions"

    git add -A
    git commit -m "Sync backend from GitHub ${GITHUB_SHA}" || echo "No changes to commit"

    git branch -M main
    git remote add origin "$REPO_URL"
    git push -u origin main --force
